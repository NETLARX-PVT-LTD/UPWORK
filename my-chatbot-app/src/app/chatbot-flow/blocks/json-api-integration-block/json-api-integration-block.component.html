<ng-container *ngIf="!isSelected">
  <div class="block-card">
    <div class="block-header ">
      <div class="block-title" (click)="onSelectBlock()">
        <img src="https://app.botsify.com/theme/images/Story-Icons/api.png" class="block-icon-img" alt="Block Icon" />
        <span>{{ block.name }}</span>
      </div>

      <div class="block-menu-icon">
        <mat-icon class="menu-trigger">more_vert</mat-icon>
      </div>
    </div>

    <div class="block-body">
      <p class="block-description">
        Integrate JSON API to 
        <strong>fetch or post data to your webservice</strong>
      </p>

      <p class="block-setup">Click <strong>â‹®</strong> to set up your block</p>
    </div>
  </div>
</ng-container>


<div
  class="connection-point connection-output"
  (mousedown)="onStartConnection($event)"
  *ngIf="!isSelected"
>
  <div class="connection-dot"></div>
</div>

<div class="connection-point connection-input" *ngIf="!isSelected">
  <div class="connection-dot"></div>
</div>

<div class="right-panel" *ngIf="isSelected">
  <div class="panel-header">
    <div class="panel-title ">JSON Plugin Integration</div>
    <div class="panel-subtitle">
      Integrate JSON API to fetch or post data to your webservice
    </div>
  </div>

  <div class="panel-content">
    <div class="section-content">
      <div class="form-group">
        <label for="api-endpoint" class="form-label">API Endpoint</label>
        <div class="input-group">
          <input
            type="url"
            id="api-endpoint"
            class="form-control"
            [(ngModel)]="block.apiEndpoint"
            placeholder="Enter Your API Endpoint"
          />
          <span class="info-icon" title="Enter the URL of your API endpoint.">
          </span>
        </div>
      </div>

      <div class="json-format-link">
        <a href="#">Check out the JSON format</a>
      </div>

      <div class="form-group">
        <label for="request-type" class="form-label">Request Type</label>
        <select id="request-type" class="form-control" [(ngModel)]="block.requestType">
          <option>POST</option>
          <option>GET</option>
          <option>PUT</option>
          <option>DELETE</option>
          <option>PATCH</option>
        </select>
      </div>

      <div class="headers-section">
        <div class="section-header">
          <h4>Select Headers</h4>
        </div>
        
        <div class="header-item" *ngIf="block.apiHeaders === undefined || block.apiHeaders.length === 0">
          <input
            type="text"
            class="form-control header-key-input"
            placeholder="Header Key"
          />
          <input
            type="text"
            class="form-control header-value-input"
            placeholder="Header Value"
          />
          <button class="icon-btn add-btn" (click)="addApiHeader()">+</button>
        </div>

        <ng-container *ngIf="block.apiHeaders && block.apiHeaders.length > 0">
          <div class="header-item" *ngFor="let header of block.apiHeaders; let i = index">
            <input
              type="text"
              class="form-control header-key-input"
              [(ngModel)]="header.key"
              placeholder="Header Key"
            />
            <input
              type="text"
              class="form-control header-value-input"
              [(ngModel)]="header.value"
              placeholder="Header Value"
            />
            <button
              class="icon-btn add-btn"
              (click)="addApiHeader()"
              *ngIf="i === block.apiHeaders.length - 1"
            >
              +
            </button>
            <button
              class="icon-btn remove-btn"
              (click)="removeApiHeader(i)"
              *ngIf="block.apiHeaders.length > 1"
            >
              &times;
            </button>
          </div>
        </ng-container>
      </div>
    </div>
  </div>
</div>