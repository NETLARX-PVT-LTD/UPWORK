<div class="p-5 bg-gray-100 min-h-screen">
  <div class="flex justify-between items-center mb-2.5">
    <h1 class="text-2xl font-semibold text-gray-800 m-0">Manage Offline Hours</h1>
    <div class="min-w-[150px]">
      <mat-form-field appearance="outline">
        <mat-select [(value)]="selectedBot">
          <mat-option value="Bot 3">Bot 3</mat-option>
          <mat-option value="Bot 1">Bot 1</mat-option>
          <mat-option value="Bot 2">Bot 2</mat-option>
        </mat-select>
      </mat-form-field>
    </div>
  </div>

  <div class="flex items-center mb-5 cursor-pointer">
    <mat-icon class="text-red-500 mr-2">play_circle_outline</mat-icon>
    <span class="text-red-500 font-medium">Tutorial</span>
  </div>

  <div class="flex gap-5">
    <div class="flex-1 bg-white rounded-lg p-5 shadow-md">
   <div class="mb-8">
  <div *ngFor="let slot of timeSlots; let i = index" class="flex gap-5 items-end mb-4">
    <div class="flex-1">
      <label class="block mb-2 font-medium text-gray-600">Select From Time</label>
      <mat-form-field appearance="outline" class="w-full">
        <input matInput type="time" [(ngModel)]="slot.fromTime" />
      </mat-form-field>
    </div>
    
    <div class="flex-1">
      <label class="block mb-2 font-medium text-gray-600">Select To Time</label>
      <mat-form-field appearance="outline" class="w-full">
        <input matInput type="time" [(ngModel)]="slot.toTime" />
      </mat-form-field>
    </div>
    
    <button *ngIf="i === timeSlots.length - 1" mat-fab color="primary" class="!bg-green-500 w-14 h-14" (click)="addTimeSlot()">
      <mat-icon>add</mat-icon>
    </button>
    <button *ngIf="timeSlots.length > 1" mat-fab color="warn" class="!bg-red-500 w-14 h-14" (click)="removeTimeSlot(i)">
      <mat-icon>remove</mat-icon>
    </button>
  </div>
</div>

      <div class="mb-8">
        <label class="block mb-4 font-medium text-gray-600">Select days</label>
        <div class="flex gap-2">
          <button 
            *ngFor="let day of days" 
            class="w-10 h-10 rounded-lg border-none font-medium cursor-pointer transition-all duration-300 hover:-translate-y-0.5 hover:shadow-lg"
            [ngClass]="{
              'bg-blue-500 text-white': day.selected,
              'bg-gray-300 text-gray-700': !day.selected
            }"
            (click)="toggleDay(day)">
            {{ day.label }}
          </button>
        </div>
      </div>

      <div class="mb-8">
        <div class="mb-5">
          <mat-slide-toggle [(ngModel)]="autoEnableDisable" color="primary">
            Do you want to auto enable/disable your bot based on these settings.
          </mat-slide-toggle>
        </div>
        
        <div>
          <mat-slide-toggle [(ngModel)]="hideBotIcon" color="primary">
            Hide your bot icon based on these settings.
          </mat-slide-toggle>
        </div>
      </div>

      <div class="mb-8">
        <div class="flex mb-5">
          <button 
            class="py-3 px-6 border-none bg-gray-100 text-gray-600 cursor-pointer transition-all duration-300 rounded-t-lg"
            [ngClass]="{'!bg-blue-500 !text-white': messageType === 'text'}"
            (click)="messageType = 'text'">
            Text Message
          </button>
          <button 
            class="py-3 px-6 border-none bg-gray-100 text-gray-600 cursor-pointer transition-all duration-300 rounded-t-lg"
            [ngClass]="{'!bg-blue-500 !text-white': messageType === 'story'}"
            (click)="messageType = 'story'">
            Story
          </button>
        </div>

        <div *ngIf="messageType === 'text'">
          <div class="relative">
            <mat-form-field appearance="outline" class="w-full">
              <textarea 
                matInput 
                placeholder="Write your message here..."
                [(ngModel)]="textMessage"
                rows="8"
                #messageTextarea></textarea>
              <button 
                mat-icon-button 
                matSuffix 
                class="text-gray-600"
                (click)="toggleVariableDropdown($event)">
                <mat-icon>code</mat-icon>
              </button>
            </mat-form-field>

            <div 
              class="absolute bg-white top-0 bottom-0 right-10 border border-gray-300 rounded-lg shadow-xl w-[300px] max-h-[400px] overflow-y-auto z-50 transition-all duration-300"
              [class.hidden]="!showVariableDropdown"
             >
              <div class="p-4 border-b border-gray-200">
                <mat-form-field appearance="outline" class="w-full">
                  <input 
                    matInput 
                    placeholder="Search variable..."
                    [(ngModel)]="variableSearch"
                    (input)="filterVariables()" />
                  <mat-icon matPrefix>search</mat-icon>
                </mat-form-field>
              </div>
              
              <div class="p-4">
                <div *ngFor="let category of getFilteredVariableCategories()" class="mb-5">
                  <h4 class="m-0 mb-2 font-semibold text-gray-800 text-sm">{{ category.name }}</h4>
                  <div class="flex flex-wrap gap-2">
                    <button 
                      class="bg-blue-500 text-white border-none py-1.5 px-3 rounded-full text-xs cursor-pointer transition-all duration-300 hover:bg-blue-600 hover:-translate-y-px"
                      *ngFor="let variable of category.variables"
                      (click)="insertVariable(variable)">
                      {{ variable.name }}
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div *ngIf="messageType === 'story'">
          <div class="flex gap-4 items-end">
            <mat-form-field appearance="outline" class="w-full">
              <mat-select 
                [(value)]="selectedStory" 
                placeholder="Select a story">
                <mat-option *ngFor="let story of stories" [value]="story.id">
                  {{ story.name }}
                </mat-option>
              </mat-select>
            </mat-form-field>
            
            <button 
              mat-raised-button 
              color="primary" 
              class="!bg-blue-500 whitespace-nowrap h-14"
              (click)="navigateToCreateStory()">
              <mat-icon>add</mat-icon>
              Create Story
            </button>
          </div>
        </div>
      </div>

      <div class="text-center">
        <button mat-raised-button color="primary" class="!bg-blue-500 text-white py-3 px-8 text-base" (click)="saveOfflineHours()">
          Set Offline Hours
        </button>
      </div>
    </div>

    <div class="w-[300px]">
      <div class="bg-white rounded-lg p-5 shadow-md">
        <div class="flex items-center mb-5">
          <mat-icon class="text-green-500 mr-2 text-3xl">lightbulb</mat-icon>
          <h3 class="m-0 text-gray-800">Rules & Tips:</h3>
        </div>
        
        <div class="flex items-start mb-4">
          <mat-icon class="text-green-500 mr-2 flex-shrink-0 mt-0.5">check_circle</mat-icon>
          <span>After setting offline hours your bot will work according to the time you set.</span>
        </div>
        
        <div class="mt-4 pt-4 border-t border-gray-200">
          <span class="text-red-500 font-medium">Timezone is GMT/UTC.</span>
        </div>
      </div>
    </div>
  </div>

  <div 
    class="fixed top-0 left-0 right-0 bottom-0 z-40 bg-transparent" 
    *ngIf="showVariableDropdown"
    (click)="showVariableDropdown = false">
  </div>
</div>